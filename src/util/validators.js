// TODO externalize the validation functions in here
